import React, { useContext, useRef, useState } from "react";
import { handleDataContext } from "../../context/handleData";

//The component for generating login form
export default function LoginPart(props) {
  const { type } = props;
  const [loginData, setLoginData] = useState({ username: "", password: "" });
  const passInputRef = useRef(null);
  const [passShow, setPassShow] = useState(false);
  const { handleSubscriberloginByUsername, handleProviderloginByUsername } =
    useContext(handleDataContext);
  const handleLogin = () => {
    if (type === "subscriber") {
      handleSubscriberloginByUsername(loginData.username, loginData.password);
    } else if (type === "provider") {
      handleProviderloginByUsername(loginData.username, loginData.password);
    }
  };
  const togglePassVisible = () => {
    console.log("hamid");
    const state = passShow;
    setPassShow(!state);
  };

  return (
    <section className="Login">
      <h1>Log in by Username and Password</h1>
      <p>
        If you have interacted with the contract and have an account you can log
        in here.
      </p>
      <form
        onSubmit={(e) => {
          e.preventDefault();
          handleLogin();
        }}
      >
        <input
          type="text"
          placeholder="Username"
          onChange={(e) => {
            setLoginData({ ...loginData, username: e.target.value });
          }}
        />
        <div className="PasswordFeild">
          <input
            type={passShow ? "text" : "password"}
            ref={passInputRef}
            placeholder="Password"
            onChange={(e) => {
              setLoginData({ ...loginData, password: e.target.value });
            }}
          />
          <div onClick={togglePassVisible}>
            {passShow ? (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21.9201 11.6C19.9001 6.91 16.1001 4 12.0001 4C7.90007 4 4.10007 6.91 2.08007 11.6C2.025 11.7262 1.99658 11.8623 1.99658 12C1.99658 12.1377 2.025 12.2738 2.08007 12.4C4.10007 17.09 7.90007 20 12.0001 20C16.1001 20 19.9001 17.09 21.9201 12.4C21.9751 12.2738 22.0036 12.1377 22.0036 12C22.0036 11.8623 21.9751 11.7262 21.9201 11.6ZM12.0001 18C8.83007 18 5.83007 15.71 4.10007 12C5.83007 8.29 8.83007 6 12.0001 6C15.1701 6 18.1701 8.29 19.9001 12C18.1701 15.71 15.1701 18 12.0001 18ZM12.0001 8C11.2089 8 10.4356 8.2346 9.77779 8.67412C9.11999 9.11365 8.6073 9.73836 8.30455 10.4693C8.0018 11.2002 7.92258 12.0044 8.07693 12.7804C8.23127 13.5563 8.61223 14.269 9.17164 14.8284C9.73105 15.3878 10.4438 15.7688 11.2197 15.9231C11.9956 16.0775 12.7999 15.9983 13.5308 15.6955C14.2617 15.3928 14.8864 14.8801 15.3259 14.2223C15.7655 13.5645 16.0001 12.7911 16.0001 12C16.0001 10.9391 15.5786 9.92172 14.8285 9.17157C14.0783 8.42143 13.0609 8 12.0001 8ZM12.0001 14C11.6045 14 11.2178 13.8827 10.8889 13.6629C10.56 13.4432 10.3037 13.1308 10.1523 12.7654C10.0009 12.3999 9.96133 11.9978 10.0385 11.6098C10.1157 11.2219 10.3061 10.8655 10.5859 10.5858C10.8656 10.3061 11.2219 10.1156 11.6099 10.0384C11.9978 9.96126 12.4 10.0009 12.7654 10.1522C13.1309 10.3036 13.4432 10.56 13.663 10.8889C13.8828 11.2178 14.0001 11.6044 14.0001 12C14.0001 12.5304 13.7894 13.0391 13.4143 13.4142C13.0392 13.7893 12.5305 14 12.0001 14Z"
                  fill="#828282"
                />
              </svg>
            ) : (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10.9399 6.08019C11.2907 6.02642 11.6451 5.99967 11.9999 6.00019C15.1799 6.00019 18.1699 8.29018 19.9099 12.0002C19.6438 12.5648 19.3433 13.1125 19.0099 13.6402C18.9041 13.804 18.8485 13.9952 18.8499 14.1902C18.8522 14.4084 18.9257 14.6199 19.0594 14.7925C19.1931 14.965 19.3795 15.089 19.5903 15.1457C19.8011 15.2024 20.0246 15.1885 20.2267 15.1063C20.4289 15.024 20.5986 14.8779 20.7099 14.6902C21.1759 13.9581 21.5806 13.1888 21.9199 12.3902C21.9736 12.2654 22.0013 12.131 22.0013 11.9952C22.0013 11.8594 21.9736 11.725 21.9199 11.6002C19.8999 6.91019 16.0999 4.00019 11.9999 4.00019C11.5306 3.99782 11.062 4.03798 10.5999 4.12019C10.4686 4.14251 10.343 4.19048 10.2302 4.26136C10.1174 4.33224 10.0197 4.42464 9.94263 4.53329C9.86555 4.64193 9.81063 4.76469 9.78101 4.89456C9.75138 5.02443 9.74762 5.15886 9.76994 5.29019C9.79227 5.42151 9.84024 5.54715 9.91112 5.65993C9.982 5.77271 10.0744 5.87043 10.183 5.9475C10.2917 6.02457 10.4144 6.07949 10.5443 6.10912C10.6742 6.13875 10.8086 6.14251 10.9399 6.12019V6.08019ZM3.70994 2.29019C3.6167 2.19695 3.50601 2.12299 3.38419 2.07253C3.26237 2.02207 3.1318 1.99609 2.99994 1.99609C2.86808 1.99609 2.73751 2.02207 2.61569 2.07253C2.49387 2.12299 2.38318 2.19695 2.28994 2.29019C2.10164 2.47849 1.99585 2.73388 1.99585 3.00019C1.99585 3.26649 2.10164 3.52188 2.28994 3.71019L5.38994 6.80019C3.97551 8.16171 2.8498 9.79417 2.07994 11.6002C2.02488 11.7264 1.99646 11.8625 1.99646 12.0002C1.99646 12.1378 2.02488 12.274 2.07994 12.4002C4.09994 17.0902 7.89994 20.0002 11.9999 20.0002C13.797 19.9878 15.5517 19.4527 17.0499 18.4602L20.2899 21.7102C20.3829 21.8039 20.4935 21.8783 20.6154 21.9291C20.7372 21.9798 20.8679 22.006 20.9999 22.006C21.132 22.006 21.2627 21.9798 21.3845 21.9291C21.5064 21.8783 21.617 21.8039 21.7099 21.7102C21.8037 21.6172 21.8781 21.5066 21.9288 21.3848C21.9796 21.2629 22.0057 21.1322 22.0057 21.0002C22.0057 20.8682 21.9796 20.7375 21.9288 20.6156C21.8781 20.4937 21.8037 20.3831 21.7099 20.2902L3.70994 2.29019ZM10.0699 11.4802L12.5199 13.9302C12.3509 13.9787 12.1758 14.0022 11.9999 14.0002C11.4695 14.0002 10.9608 13.7895 10.5857 13.4144C10.2107 13.0393 9.99994 12.5306 9.99994 12.0002C9.99789 11.8244 10.0215 11.6492 10.0699 11.4802ZM11.9999 18.0002C8.81994 18.0002 5.82994 15.7102 4.09994 12.0002C4.74603 10.5739 5.66301 9.28676 6.79994 8.21019L8.56994 10.0002C8.15419 10.759 7.99568 11.6321 8.1182 12.4886C8.24072 13.3452 8.63766 14.1388 9.24947 14.7507C9.86128 15.3625 10.655 15.7594 11.5115 15.8819C12.368 16.0044 13.2411 15.8459 13.9999 15.4302L15.5899 17.0002C14.501 17.6411 13.2634 17.9858 11.9999 18.0002Z"
                  fill="#828282"
                />
              </svg>
            )}
          </div>
        </div>
        <input type="submit" value="Log in" />
      </form>
    </section>
  );
}
